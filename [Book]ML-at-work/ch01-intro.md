# 머신러닝 프로젝트 처음 시작하기

## 머신러닝을 어떻게 동작하는가

지도학습, 비지도 학습, 강화학습 등이 있다.

지도학습은 학습단계와 예측단계로 구성된다.

## 머신러닝 프로젝트의 과정

머신러닝으로 성공한 사례를 볼 때는 다음 세가지 질문을 살펴보자.

* 어떤 알고리즘을 사용하였는가?
* 어떤 데이터를 특징으로 사용하였는가?
* 머신러닝을 어떻게 통합하였는가?

머신러닝으로 해결 가능한 것과 그렇지 않을 것을 구분하는 것이 중요하다.

> 데이터 분석의 80%는 전처리

### 문제정의하기

풀려고 하는 문제를 정의해야한다. 분석하는 과정에서 KPI(Key Performance Indicator, 핵심성과지표)가 발견되기 마련이다.

이와 관련해서는 `린 스타트업`과 `린 분석` 두 권의 책을 참조하자.

가설을 세우고 검증하는 방법은 쿡패드 개발자 블로그 [가설 검증과 샘플 크기의 기초](http://techlife.cookpad.com/entry/2016/09/26/111601)를 참조하자. 일본어다. -_-

### 머신러닝을 사용하지 않는 방법 검토하기

> 머신러닝은 기술부채 중 이자율이 매우 높은 신용카드다. - Sculley et al., 2014

머신러닝을 사용하는 시스템에는 다음과 같은 어려움이 있을 수 있다.

* 확률적인 부분으로 인해 자동 테스트가 어렵다.
* 오래 운용하면 사용자 경향이 변해서 입력 경향도 바뀐다.
* 처리 파이프가 복잡해진다.
* 데이터 의존관계가 복잡해진다.
* 실험 코드 혹은 실험 파라미터가 포함되기 쉽다.
* 개발 시스템과 운영시스템 간의 언어/프레임워크가 파편화된다.

같은 단어가 트렌드가 바뀌면서 호오가 바뀌기도 한다. 혹은 자바와 같은 단어의 뜻이 지역명, 커피, 프로그래밍 언어와 같이 주요 의미가 바뀌기도 한다. 또한 난수를 이용하기 때문에 결과가 비결정적이고, 워낙 큰 데이터셋을 다루기 때문에, 생각치 못한 예측결과를 내보낼 수 있다. 따라서 사후에 시스템에 개입할 여지를 남겨두어야 한다.

따라서, 머신러닝이 적합한 비지니스 문제는 다음과 같은 조건을 가져야 한다.

* 대량의 데이터에서 고속으로 안정적인 판단을 요구받는다.
* 예측 결과에 일정 수준의 오류가 용인된다.

이러한 조건이 갖추어지면, MVP(Minimum Viable Product, 최소기능제품)를 만들어 본다. "린 스타트업"에서 다루는 주제로 고객가치를 창출할 수 있는 최소한의 제품을 의미한다.

머신러닝은 문제 설정에서 가설 검증에 이르는 사이클이 일반적인 개발주기에 비해서 긴 편이므로, 고객 니즈 및 개념 정리가 명확히 되었는지 미리 살펴볼 필요가 있다.

### 시스템 설계하기

문제 정의와 MVP 검증이 끝나면, 머신러닝 시스템을 설계해야 한다. 중요한 질문은 다음과 같다.

* 예측 결과를 어떻게 이용할 것인가?
* 예측 오류의 영향을 어떻게 흡수할 것인가?

예측 결과를 이용하는 방법은 예측 결과를 배치로 처리하여 데이터베이스에 저장하는 방식과 사용자 액션마다 비동기적으로 처리하는 방법이 있다.

오류에 대처하기 위해, 예측 결과를 사람이 직접 확인 후 시스템에 적용되도록 하는 방식을 생각할 수 있다. 그 피해가 크지않다면, 직접 시스템에 적용할 수도 있다.

실제 작업(데이터 수집, 모델 작성, 시스템 구축)에 들어가면, 목표 성능과 포기 지점을 설정해야 한다. 그렇지 않으면, 끝없이 개선하는 늪에 빠지거나 근자감에 빠지기 쉽다.

### 알고리즘 선택하기

데이터 특성을 모른다면, 군집화 같은 비지도 학습이나, 스캐터플롯 매트릭스 등으로 데이터를 탐색할 수 있다.

데이터 양에 기초하여 온라인 학습과 배치학습 중에 어느 쪽이 더 적합한지 판단할 수 있다.

### 특성, 레이블, 로그 설계하기

특성은 모델에 입력되는 정보이다. 수치화된 자료를 이용하나, 범주형 변수는 더미 변수를 이용하여 수치화한다. 사이킷런의 `LabelEncoder`나 `OneHotEncoder`을 이용할 수 있다.

고전 머신러닝에서는 적합한 특성을 선택하는 것이 모델링의 핵심이었다. 따라서 도메인 전문가의 경험적 지식이 중요하다. 이 경우 불필요한 데이터는 나중에 제거할 수는 있지만, 필요한 정보를 나중에 추가하는 것은 매우 어렵다.

특성이 준비되면, 입력 데이터로 쓸 정답 데이터가 필요하다.

지도학습에서는 품질이 높은 정답 레이블을 확보하는 것이 중요하다.

서버의 로그에서 정답 데이터를 찾기도 한다.

### 데이터 전처리

전처리는 문제와 데이터에 따라 달라지나, 기본적으로 불필요한 정보를 발라내고, 데이터를 머신러닝에 이용할 수 있는 형태로 만드는 것이 주된 일이다. 관개형 데이터베이스가 이상적인 형태이나, 로그 같은 경우는 특정한 형식에 맞추어 변환할 필요가 있고, 수치 데이터는 누락값이나 이상치를 처리해야 한다. 값의 변동폭이 크게 차이날 경우에는 정규화같은 과정이 필요하다. 텍스트 데이터는 빈도를 세거나, 빈도가 적은 단어를 입력 자료에서 제외하기도 한다. 범주형 변수를 더미 변수로 바꾸는 작업 역시 전처리의 주요한 작업 중 하나이다.
