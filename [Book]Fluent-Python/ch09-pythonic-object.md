# 파이썬스러운 객체

> 절대로 결코 앞에 언더바 두 개를 사용하지 말라. 이것은 짜증스러울 정도로 개인적인 이름이다.  - 이안 비킹. [Paste 스타일 가이드](http://pythonpaste.org/StyleGuide.html)에서 발췌

## 객체의 표현

```repr()```는 개발자가 보고자 하는 형태로 표현한 문자열, ```str()```은 사용자가 보고자 하는 형태로 표현한 문자열을 반환한다.

## 벡터 클래스의 구현

[깃헙 페이지](https://github.com/fluentpython/example-code/tree/master/09-pythonic-obj)를 참고하자.

```byte()``` 함수로 저장하고, ```memoryview()```와 ```cast()```로 로딩이 가능하다.

## @classmethod와 @staticmethod

이 두 데커레이터는 ```self```를 생략하게 만드는데, 전자는 해당 클래스를 첫 인자로 받게 만들어주고, 후자는 첫번째 인자를 무시하게끔 만든다.

## 포멧된 출력

내장함수인 ```format()```과 메서드인 ```str.format()```를 이용한다. format에서 이용되는 형식을 [포맷 명시 간이 언어(Format Specification Mini-Language)](http://bit.ly/1Gt4vJF)라고 부른다. 

## 해시 가능한 Vector2D

지금까지 정의한 Vector2D는 해시할 수 없으므로, 집합에 쓸 수 없다. 해시 가능하게 하려면 ```__hash()__```를 구현해야 한다. 해시 가능하게 하려면 우선 불변형으로 만들어야 한다.

```@property``` 데커레이터를 통해서 변수의 직접 접근을 막고, 읽기 전용으로 만든다. 불변형이 된 상태에서 해시 함수를 구현해야 한다. 해시 함수는 반드시 int 형을 반환해야 한다. 동일한 객체는 동일한 해시를 가져야 하므로, ```__eq()__``` 함수에서 이용한 특성을 이용해서 구현하는 것이 좋다. 공식 문서에는 요소의 해시에 비트 단위 XOR 연산자 (^)를 사용하는 것을 권장한다. Vector2D는 다음과 같이 구현할 수 있다.

```python
def __hash__(self):
    return hash(self.x) ^ hash(self.y)
```

## 파이썬에서의 비공개 속성과 보호된 속성

파이썬에서는 클래스의 상속 과정에서 변수명이 중복되는 것을 방지하기 위해서 이름 장식(name mangling)이라고 하는 방식을 도입하였다. 변수명앞에 클래스명을 추가로 붙여준다. 하지만 이는 보안 기능은 아니다. 실수를 방지하지만 고의적인 악용을 막지는 못한다. 이안 비킹은 이와 관련하여 언더바 두개(던더, dunder)를 쓰지 말것을 주장하면서, 차라리 던더 대신 언더바+클래스명+언더명을 쓰라고 주장한다. 이 또한 나쁘지만 최소한 의도가 명확하게 보이기 때문이다.

파이썬에서는 관례적으로 언더바 1개는 보호된 속성이라고 생각하고 사용하는 측면에서 의도적으로 사용하지 않으려고 하는 관례가 있지만, 강제적으로 규정할 수는 없다.

## ```__slot___``` 클래스 속성으로 공간 절약하기

파이썬은 기본적으로 객체 속성을 각 객체 안의 ```__dict__```라는 딕셔너리형 속성에 저장한다. 이는 빠르게 속성에 접근할 수 있게 하지만, 메모리 사용량 부담이 커지게 된다. 이 때 ```__slot__``` 클래스 속성을 이용하면 딕셔너리 대신 튜플에 저장하게 만듦으로써 메모리 사용량을 엄청나게 줄일 수 있다.
